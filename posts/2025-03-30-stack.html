<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">

<head>
  <script>
    (function () {
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        document.documentElement.classList.add('dark-mode');
      }
    })();

    function loadUtterances() {
      const savedTheme = localStorage.getItem('theme');
      const themeValue = savedTheme === 'dark' ? 'github-dark' : 'github-light';

      console.log("theme");
      console.log(themeValue);
      const script = document.createElement('script');
      script.src = 'https://utteranc.es/client.js';
      script.setAttribute('repo', 'lionhairdino/lionhairdino.github.io');
      script.setAttribute('issue-term', 'url');
      script.setAttribute('theme', themeValue);
      script.setAttribute('crossorigin', 'anonymous');
      script.async = true;
      document.body.appendChild(script);
    };

    function updateUtterancesTheme() {
      const savedTheme = localStorage.getItem('theme');
      const themeValue = savedTheme === 'dark' ? 'github-dark' : 'github-light';

      // Utterances iframe에 메시지 전송
      const utterances = document.querySelector('.utterances iframe');
      if (utterances) {
        utterances.contentWindow.postMessage(
          {type: 'set-theme', theme: themeValue},
          'https://utteranc.es'
        );
      }
    }

  </script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>lionhairdino - Stack (작성 중)</title>
  
  <meta name="description" content="lionhairdino - Stack (작성 중)" />
  <meta property="og:description" content="하스켈 함수형 프로그래밍" />
  
  <link rel="stylesheet" type="text/css" href="../css/default.css" />
  <link rel="icon" href="https://lionhairdino.github.io/favicon.svg" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino16px.png" sizes="16x16" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino24px.png" sizes="24x24" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino32px.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino48px.png" sizes="48x48" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino57px.png" sizes="57x57" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino60px.png" sizes="60x60" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino64px.png" sizes="64x64" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino72px.png" sizes="72x72" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino76px.png" sizes="76x76" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino114px.png" sizes="114x114" />
  <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino120px.png" sizes="120x120" />
  <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino144px.png" sizes="144x144" />
  <link rel="shortcut icon" href="../favicon.ico" />
  <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino152px.png" sizes="152x152" />
  <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino180px.png" sizes="180x180" />
  <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino192px.png" sizes="192x192" />
  <link rel="manifest" href="../site.webmanifest" />
  <link rel="mask-icon" href="https://lionhairdino.github.io/Lionhairdino_black.svg" color="#ff7500" />
  <meta name="msapplication-TileImage" content="/images/favicon/Lionhairdino144px.png" />
  <meta name="msapplication-TileColor" content="#ff7500" />
  <meta name="theme-color" content="#ffffff" />
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Stack (작성 중)" />
  <meta property="og:site_name" content="Lionhairdino" />
  <meta property="og:url" content="https://lionhairdino.github.io/posts/2025-03-30-stack.html" />
  
  <meta property="og:image" content="https://lionhairdino.github.io/images/state400px.png" />
  
  
  <meta name="keywords" content="Haskell, 하스켈, Stack, 스택, Build, 빌드">
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-E9WZ6VXGHP"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-E9WZ6VXGHP');
  </script>
  <script src="../script/copycode.js"></script>

  <script src="../script/darkmode.js"></script>
  <script async src="https://cse.google.com/cse.js?cx=9c53b4915cbb2605c"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css" />
  <meta name="fediverse:creator" content="@lionhairdino@mastodon.social" />
  <link rel="alternate" type="application/rss+xml" title="상상 하스켈 - Lionhairdino" href="rss.xml" />
</head>

<body>
  <div id="header">
    <div style="display:inline-block;margin-right:5px;padding-top: 5px;" id="logo">
      <a href="../"><img style="width:30px;border:none" src="../images/favicon/Lionhairdino48px.png"></a>
    </div>
    <div style="display:inline-block;vertical-align: top;padding-top:5px;" id="navigation">
      <a href="../">lionhairdino</a>
      <a href="../about.html">about</a>
      <!--<a href="/archive.html">archive</a>-->
    </div>
    <div style="display:inline-block;font-size:0.8em;vertical-align: top;">
      <div style="display:inline-block;vertical-align: top;padding-top: 5px"></div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 10px;"><a rel="me" href="https://mastodon.social/@lionhairdino"><img style="width:20px;border:none" src="../images/mastodon.svg"></a></div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 2px;"><a rel="me" href="https://lionhairdino.bsky.social"><img style="width:18px;border:none" src="../images/bluesky.svg"></a>
      </div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 2px;"><a rel="me" href="https://discordapp.com/users/lionhairdino#7687"><img style="width:20px;border:none" src="../images/discord.svg"></a></div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 2px;"><a rel="me" href="https://x.com/lionhairdino"><img style="width:15px;border:none" src="../images/X.svg"></a></div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 2px;"><a rel="me" href="https://linkedin.com/in/lionhairdino-l-baaa54244"><img style="width:20px;border:none" src="../images/linkedin.svg"></a></div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 2px;"><a rel="me" href="https://github.com/lionhairdino"><img style="width:20px;border:none" src="../images/github.svg"></a></div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 2px;"><a rel="me" href="https://www.threads.net/@linohairdino"><img style="width:20px;border:none" src="../images/threads.svg"></a></div>
      <div style="display:inline-block;vertical-align: top;padding-top: 11px; padding-left: 2px;"><a rel="me" href="https://hackers.pub/@lionhairdino">Hackers'Pub</a></div>
    </div>
    <div>
      <div style="display:inline-block;width:180px;">
        <div class="gcse-searchbox-only"></div>
        <div><button id="theme-toggle">
            <script>
              const savedTheme = localStorage.getItem('theme');
              if (savedTheme === 'dark')
                document.write("☉");
              else
                document.write("☾");
            </script>
          </button></div>
      </div>
    </div>
    <div>
      여기 글들은 일종의 질문입니다. 용어 선택도 학계, 업계에서 쓰는 걸로 되어 있지 않고, 틀린 내용이 있을 수도 있습니다. 여기 글을 처음 읽는 분은, 먼저 <a href="../warning.html">주의문</a>을 꼭 읽어보세요.
    </div>
  </div>
  <div class="js-toc-content">
    <h1>Stack (작성 중)</h1>
    <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
<div class="info">
    Posted on March 30, 2025
    
</div>

<p><a href="https://docs.haskellstack.org/en/stable/">The Haskell Tool Stack</a></p>
<p><code>stack.yaml</code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">###### Project-specific</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">snapshot</span><span class="kw">:</span><span class="at"> lts-23.14</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># snapshot: ghc-9.8.4 스냅샷 없이 컴파일러와 같이 배포된 패키지 이용한다.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># resolver는 snapshot의 동의어, 둘 중 하나만 지정한다.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">packages</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> my-package</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">-</span><span class="at"> dir3/my-other-package</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 현재 프로젝트가 가진 패키지 목록</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># packages: . 기본값으로 싱글 프로젝트 패키지를 의미</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">extra-deps</span><span class="kw">:</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 스냅샷에 없는 패키지나 버전. 같은 이름의 스냅샷 패키지는 가려진다.</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># @TODO 팬트리: (영단어 뜻은 찬장 같은 것) 스냅샷에 없는 것들을 Hackage, Git, 로컬등에서 </span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co">#               가져와 써먹고 캐싱해 둔 걸 팬트리 패키지라 부르는 것 같다.</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">#               ※ 특이사항: GHC boot 패키지는 여기다 써봐야 무시된다고 한다.</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ghc-options</span><span class="kw">:</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">flags</span><span class="kw">:</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">package-name</span><span class="kw">:</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">flag-name</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 명령 줄 옵션과 동일</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 스냅샷 패키지에 지정된 모든 Cabal 플래그 설정을 덮어씌운다.</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">drop-packages</span><span class="kw">:</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">user-message</span><span class="kw">:</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="co"># stack이 이 설정 파일을 읽어들일 때마다 출력</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">custom-preprocessor-extensions</span><span class="kw">:</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="fu">extra-package-dbs</span><span class="kw">:</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="fu">curator</span><span class="kw">:</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># 2025.3 아직은 실험적인 필드</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co">###### Non-project specific</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="fu">allow-newer</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># cabal 파일에 있는 버전 제약 무시</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="fu">allow-newer-deps</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 위 allow-newer 설정이 적용될 하위 패키지들 지정</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="fu">arch</span><span class="kw">:</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="co"># stack이 동작하는 머신 아키텍처</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a><span class="fu">compiler</span><span class="kw">:</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 스냅샷에 있는 컴파일러 버전을 덮어 씌운다.</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="fu">extra-lib-dirs</span><span class="kw">:</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 빌드 환경 구성을 위해 필요한 라이브러리를 찾을 경로 </span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="fu">hpack-force</span><span class="kw">:</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="co"># .cabal 파일이 수작업으로 수정됐을 때, hpack이 덮어 쓸지 여부</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="co"># hpack 0.20부터는 덮어 쓰기 거부가 기본값</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="fu">install-ghc</span><span class="kw">:</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a><span class="co"># GHC를 다운로드하고 설치할지 여부.</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="fu">local-bin-path</span><span class="kw">:</span><span class="at"> ~/.local/bin</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="co"># stack build --copy-bins(stack install과 동일)이 패키지를 설치할 경로</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="fu">nix</span><span class="kw">:</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">enable</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pure</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">package</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">shell-file</span><span class="kw">:</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">nix-shell-options</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">path</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">add-gc-roots</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="fu">system-ghc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a><span class="co"># 시스템에 있는 (Path에 잡혀 있는) GHC를 쓸지 말지 여부</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="fu">with-hpack</span><span class="kw">:</span><span class="at"> /usr/local/bin/hpack</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co"># stack 빌트인 hpack이 아닌, 별도 hpack 실행 파일을 쓴다.</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a><span class="fu">work-dir</span><span class="kw">:</span><span class="at"> .stack-work</span></span></code></pre></div>
<p><code>stack new sample</code><br />
<code>sample/</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>├── app</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>│   └── Main.hs</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>├── CHANGELOG.md</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>├── LICENSE</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>├── package.yaml</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>├── README.md</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>├── sample.cabal</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>├── Setup.hs</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>├── src</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>│   └── Lib.hs</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>├── stack.yaml</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>└── test</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    └── Spec.hs</span></code></pre></div>
<h2 id="stack-work-디렉토리">Stack work 디렉토리</h2>
<p><a href="https://docs.haskellstack.org/en/stable/topics/stack_work/">Stack work directory</a></p>
<p>특별히 옵션을 주지 않으며, 빌드 중에 필요한 파일들과, 최종 빌드된 바이너리 모두 이 아래 위치합니다. (한 눈에 살펴 본적이 없었는데, 많이도 생성됩니다. <code>stack build</code>, <code>stack install</code> 후의 모습입니다.)<br />
<code>.stack-work/</code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>├── dist</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>│   └── x86_64-linux-nix</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>│       └── ghc-9.6.4 ----* stack path --dist-dir로 확인</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>│           ├── build</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>│           │   ├── autogen</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>│           │   │   ├── cabal_macros.h</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>│           │   │   ├── PackageInfo_sample.hs</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>│           │   │   └── Paths_sample.hs -----------------* Paths_pkgname 모듈</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>│           │   ├── Lib.dyn_hi</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>│           │   ├── Lib.dyn_o</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>│           │   ├── Lib.hi</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>│           │   ├── libHSsample-0.1.0.0-2tRkpRkMrLYKl9DJwHDpTe.a</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>│           │   ├── libHSsample-0.1.0.0-2tRkpRkMrLYKl9DJwHDpTe-ghc9.6.4.so</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>│           │   ├── Lib.o</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>│           │   ├── Paths_sample.dyn_hi</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>│           │   ├── Paths_sample.dyn_o</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>│           │   ├── Paths_sample.hi</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>│           │   ├── Paths_sample.o</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>│           │   └── sample-exe</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>│           │       ├── autogen</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>│           │       │   ├── cabal_macros.h</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>│           │       │   ├── PackageInfo_sample.hs</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>│           │       │   └── Paths_sample.hs -----------------* Paths_pkgname 모듈</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>│           │       ├── sample-exe --------------* 실행 파일</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>│           │       └── sample-exe-tmp</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>│           │           ├── Main.hi</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>│           │           ├── Main.o</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>│           │           ├── Paths_sample.hi</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>│           │           └── Paths_sample.o</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>│           ├── build-lock</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>│           ├── package.conf.inplace</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>│           │   ├── package.cache</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>│           │   ├── package.cache.lock</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>│           │   └── sample-0.1.0.0-2tRkpRkMrLYKl9DJwHDpTe.conf</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>│           ├── setup-config</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>│           ├── stack-build-caches</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>│           │   └── d6bc1450919ab91c0c8fcf9d9e33fcc28df25df98110f462287e036fb400 2bc3</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>│           │       ├── exe-sample-exe</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>│           │       └── lib</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>│           ├── stack-cabal-mod ----* 수정 시각 확인 용도</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>│           ├── stack-project-root ----* 프로젝트 개발의 루트 디렉토리를 가진 txt 파일</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>│           └── stack-setup-config-mod</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>├── install</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>│   └── x86_64-linux-nix</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>│       ├── af9ab2fb7015c65f339c4bb931b57f680cb5ea6b6d26131227e597eb096d0623</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>│       │   └── 9.6.4</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>│       │       └── pkgdb</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>│       │           ├── package.cache</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>│       │           └── package.cache.lock</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>│       └── d6bc1450919ab91c0c8fcf9d9e33fcc28df25df98110f462287e036fb4002bc3</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>│           └── 9.6.4 ----* stack path --local-install-root로 확인</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>│               ├── bin</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>│               │   └── sample-exe  --------------* 실행 파일</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>│               ├── doc ----* stack path --local-doc-root로 확인</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>│               │   └── sample-0.1.0.0</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>│               │       └── LICENSE</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>│               ├── lib</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>│               │   └── x86_64-linux-ghc-9.6.4</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>│               │       ├── libHSsample-0.1.0.0-2tRkpRkMrLYKl9DJwHDpTe-ghc9.6.4. so</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>│               │       └── sample-0.1.0.0-2tRkpRkMrLYKl9DJwHDpTe</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>│               │           ├── Lib.dyn_hi</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>│               │           ├── Lib.hi</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>│               │           ├── libHSsample-0.1.0.0-2tRkpRkMrLYKl9DJwHDpTe.a</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>│               │           ├── Paths_sample.dyn_hi</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>│               │           └── Paths_sample.hi</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>│               ├── pkgdb ----* stack path --local-pkg-db로 확인 </span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>│               │   ├── package.cache</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>│               │   ├── package.cache.lock</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>│               │   └── sample-0.1.0.0-2tRkpRkMrLYKl9DJwHDpTe.conf</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>│               └── share</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>│                   └── x86_64-linux-ghc-9.6.4</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>│                       └── sample-0.1.0.0</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>│                           └── config.txt  --------------* 데이터 파일</span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>├── stack.sqlite3</span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>└── stack.sqlite3.pantry-write-lock</span></code></pre></div>
<h2 id="hpack">Hpack</h2>
<p><a href="https://github.com/sol/hpack#readme">Hpack</a>: Cabal 패키지 형식 <code>.cabal</code>을 생성하기 위한 전처리기 같은 역할입니다. Hpack 형식은 패키지들을 <code>package.yaml</code> 파일에 기술합니다. <code>cabal2nix</code>와 <code>stack</code>은 네이티브로 <code>hpack</code>을 가지고 있어, 이 파일을 해석할 수 있습니다. 단독 CLI 도구 <code>hpack</code>으로도 이 파일을 읽어 <code>.cabal</code> 파일을 생성할 수 있습니다. Hpack 형식과 Cabal 형식 둘을 비교하면, 크게 달라 보이진 않는데, 공통된 부분을 한 번만 작성해서 <code>libararay:</code>, <code>tests:</code>, <code>executables:</code> 등의 타겟으로 모두 쓸 수 있다든지, 약간 더 편의성이 높은 정도로 보이는데요. Hpack 형식을 변환 없이 그대로 주 형식으로 선택했어도 될 것 같은데, 호환성이 때문에 Cabal 형식을 유지하고 있는 게 아닐까 추측합니다. 어쨌든, Cabal 형식을 작성하는 것보다는 아주 조금 더 편리합니다.</p>
<h3 id="paths_-모듈의-동작">Paths_ 모듈의 동작</h3>
<p>Cabal은 모든 모듈마다 <code>Paths_</code> 모듈을 각 각 생성합니다. 이 들 모듈들에 대해서 어떤 동작을 할지는 <code>spec-version</code> 필드 값에 따라 달라집니다.</p>
<p>모던 동작을 하려면 적어도 <code>0.36.0</code> 이상이어야 하고, 이보다 낮으면 레거시 동작을 합니다.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spec-version</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.36.0</span></span></code></pre></div>
<h4 id="모던-동작">모던 동작</h4>
<p>※ <code>Executable</code>, <code>Libary</code>, <code>Test</code> 같은 것들을 컴포넌트라 부릅니다.<br />
컴포넌트를 위해 <code>Paths_</code> 모듈을 사용하길 원하면, 명시적으로 <code>generated-other-modules</code>에 지정해야 합니다.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span><span class="kw">:</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">source-dirs</span><span class="kw">:</span><span class="at"> src</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">generated-other-modules</span><span class="kw">:</span><span class="at"> Paths_name</span><span class="co"> # name 부분을 패키지 이름으로 바꿉니다.</span></span></code></pre></div>
<h4 id="레거시-동작">레거시 동작</h4>
<p>역사적인 이유로, Hpack은 <code>.cabal</code> 파일을 생성할 때 <code>Paths_</code> 모듈을 <code>other-modules</code>에 추가합니다.<br />
이러지 않게 하려면, <code>package.yaml</code>에 다음과 같이 설정합니다.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span><span class="kw">:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">when</span><span class="kw">:</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">condition</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">other-modules</span><span class="kw">:</span><span class="at"> Paths_name</span></span></code></pre></div>
<h2 id="paths_-모듈">Paths_ 모듈</h2>
<p><a href="https://cabal.readthedocs.io/en/3.4/cabal-package.html#accessing-data-files-from-package-code">7.6 Accessing data files from package code</a><br />
<code>data-files</code> 필드에 써 준 파일들의 위치는 시스템마다 다를 수 있습니다. 어떤 경우는 설치 후 파일을 이동할 수도 있습니다. 패키지가 이런 데이터 파일을 런타임에 찾을 수 있게 하기 위해 Cabal이 <code>Paths_pkgname</code>이란 모듈을 생성합니다. 예를 들어 패키지가 <code>data/words.txt</code>란 데이터 파일을 참조하는데, 이 파일을 패키지에 포함시키더라도, 패키지가 설치될 곳을 미리 알 수 없기 때문에 하드 코딩할 수 없습니다. 이럴 때 <code>Paths_pkgname</code> 모듈을 이용해 설치 경로를 동적으로 얻을 수 있습니다.<br />
※ <code>pkgname</code>에 있는 하이픈은 모두 언더스코어<code>_</code>로 바뀝니다.<br />
<code>Paths_pkgname</code>은 아래 함수를 가지고 있습니다.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ot">getDataFileName ::</span> <span class="dt">FilePath</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> <span class="dt">FilePath</span></span></code></pre></div>
<p><code>Paths_pkgname</code> 모듈을 사용하려면, <code>other-modules</code>와 <code>autogen-modules</code>에 적어 줘야 합니다.
<code>Paths_pkgname</code> 모듈은 다른 자동 생성 모듈처럼 플래폼 독립적이지 않기 때문에, <code>sdist</code>가 생성한 소스 tarballs에 포함되지 않습니다.</p>
<p>※ <code>stack sdist</code> Hackage에 등록 가능한 형태로, 패키지 아카이브 파일을 만듭니다.</p>
<h3 id="예시">예시</h3>
<p><code>config.txt</code></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>Data contents</span></code></pre></div>
<p><code>package.yaml</code>의 탑레벨에 아래를 추가합니다.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data-files</span><span class="kw">:</span><span class="at"> config.txt</span></span></code></pre></div>
<p><code>src/Lib.hs</code></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> <span class="dt">Lib</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    ( someFunc</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    ) <span class="kw">where</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="ot">someFunc ::</span> <span class="dt">IO</span> ()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>someFunc <span class="ot">=</span> <span class="fu">putStrLn</span> <span class="st">&quot;someFunc&quot;</span></span></code></pre></div>
<p><code>app/Main.hs</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> <span class="dt">Main</span> (main) <span class="kw">where</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Paths_sample</span> (getDataFileName, getDataDir)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Lib</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  someFunc</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  dir <span class="ot">&lt;-</span> getDataDir</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  filePath <span class="ot">&lt;-</span> getDataFileName <span class="st">&quot;config.txt&quot;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  content <span class="ot">&lt;-</span> <span class="fu">readFile</span> filePath</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">putStrLn</span> <span class="op">$</span> <span class="st">&quot;Data dir: &quot;</span> <span class="op">++</span> dir</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">putStrLn</span> <span class="op">$</span> content <span class="op">++</span> <span class="st">&quot; in \n&quot;</span> <span class="op">++</span> filePath</span></code></pre></div>
<p>그리고 <code>stack sdist</code>하면, <code>.cabal</code>에 아래가 추가된 걸 확인할 수 있습니다.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data-files</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="at">  config.txt</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">...</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">library</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">  ...</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">  other-modules:</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co">      Paths_sample</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">  autogen-modules:</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">      Paths_sample</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co">   ...</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">executable</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co">  ...</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co">  other-modules:</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="co">      Paths_sample</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co">  autogen-modules:</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co">      Paths_sample</span></span></code></pre></div>
<p>Cabal이 빌드 과정에서 자동으로 생성해서 바이너리에 포함시킵니다. 빌드에 임시로 생성한 폴더인 <code>/home/lionhairdino/workroom/stack_sample/sample/.stack-work/dist/x86_64-linux-nix/ghc-9.6.4/build/sample-exe/autogen</code> 폴더에서 <code>Paths_sample.hs</code> 파일을 볼 수 있습니다.</p>
<p>실제 데이터 파일의 위치는, 저의 경우는 다음과 같이 잡혔습니다.(stack은 nix가 활성화된 상태입니다.)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>someFunc</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>Data dir: /home/lionhairdino/workroom/stack_sample/sample/.stack-work/install/x86_64-linux-nix/d6bc1450919ab91c0c8fcf9d9e33fcc28df25df98110f462287e036fb4002bc3/9.6.4/share/x86_64-linux-ghc-9.6.4/sample-0.1.0.0</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>Data contents</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a> in </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>/home/lionhairdino/workroom/stack_sample/sample/.stack-work/install/x86_64-linux-nix/d6bc1450919ab91c0c8fcf9d9e33fcc28df25df98110f462287e036fb4002bc3/9.6.4/share/x86_64-linux-ghc-9.6.4/sample-0.1.0.0/config.txt</span></code></pre></div>
<p>실행 파일의 위치는 다음과 같습니다.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>/home/lionhairdino/workroom/stack_sample/sample/.stack-work/dist/x86_64-linux-nix/ghc-9.6.4/build/sample-exe</span></code></pre></div>
<p>실행 파일 위치와 데이터 파일의 위치를 나란히 보면 다음과 같습니다.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dist/x86_64-linux-nix/ghc-9.6.4/build/sample-exe/sample-exe</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>install/x86_64-linux-nix/해시/9.6.4/share/x86_64-linux-ghc-9.6.4/sample-0.1.0.0/config.txt</span></code></pre></div>
<p>자동 생성된 <code>Paths_sample.hs</code> 파일을 열어 보면,</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode hs"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>getBinDir     <span class="ot">=</span> catchIO (getEnv <span class="st">&quot;sample_bindir&quot;</span>)     (\_ <span class="ot">-&gt;</span> <span class="fu">return</span> bindir)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>getLibDir     <span class="ot">=</span> catchIO (getEnv <span class="st">&quot;sample_libdir&quot;</span>)     (\_ <span class="ot">-&gt;</span> <span class="fu">return</span> libdir)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>getDynLibDir  <span class="ot">=</span> catchIO (getEnv <span class="st">&quot;sample_dynlibdir&quot;</span>)  (\_ <span class="ot">-&gt;</span> <span class="fu">return</span> dynlibdir)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>getDataDir    <span class="ot">=</span> catchIO (getEnv <span class="st">&quot;sample_datadir&quot;</span>)    (\_ <span class="ot">-&gt;</span> <span class="fu">return</span> datadir)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>getLibexecDir <span class="ot">=</span> catchIO (getEnv <span class="st">&quot;sample_libexecdir&quot;</span>) (\_ <span class="ot">-&gt;</span> <span class="fu">return</span> libexecdir)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>getSysconfDir <span class="ot">=</span> catchIO (getEnv <span class="st">&quot;sample_sysconfdir&quot;</span>) (\_ <span class="ot">-&gt;</span> <span class="fu">return</span> sysconfdir)</span></code></pre></div>
<p>런타임에 환경 변수를 읽어, 각 디렉토리들을 바꿀 수 있음을 알 수 있습니다.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>stack_sample/sample/result&gt; sample_datadir=. ./sample-exe </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>someFunc</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>Data dir: .</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>Data contents</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a> in </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>config.txt</span></code></pre></div>
<p><span class="citation" data-cites="TODO">@TODO</span><br />
<code>Paths_sample.hs</code>를 열어 보면, 위 디렉토리값들이 현재 개발 중인 상황에서 build했을 때 쓰인 폴더명들이 모두 하드 코딩되어 있다. 이러면, 최종 바이너리에 개발 환경 흔적(환경 변수가 설정되어 있지 않을 때 쓸 기본값)이 남는 것 아닐까?</p>
<h2 id="마무리">마무리</h2>
<p>몇 년 전에는, 생태계에서 꽤 중요한 요소인듯한데, (아마도 규모가 그리 크지 않은) 하나의 상업 회사가 이끄는 게 불안하지 않나 생각했었는데요. 지금은 <a href="https://github.com/commercialhaskell/commercialhaskell">Commercial Haskell</a> 그룹에서 후원을 받아 개발되고 있다고 합니다.</p>

<div class="comment">
  <script>
    document.addEventListener('DOMContentLoaded', loadUtterances, { once: true });
  </script>
</div>
<div style="text-align:right">Github 계정이 없는 분은 메일로 보내주세요. lionhairdino at gmail.com </div>

  </div>
  <nav class="toc toc-right js-toc relative z-1 transition--300 absolute pa4 pt5 is-position-fixed"></nav>
  <script>
    tocbot.init({
      tocSelector: '.js-toc',
      contentSelector: '.js-toc-content',
      headingSelector: 'h2, h3',
      hasInnerContainers: true,
    });
  </script>
  <div id="footer">
    © 2025 lionhairdino. All rights reserved. Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
  </div>
  <script language="javascript">
    const observer = new IntersectionObserver(entries => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add("visible");
        }
      });
    },{
      root: null,
      rootMargin: "0px 0px -30% 0px",
      threshold: 0.5
    });
    document.querySelectorAll('em').forEach(elem => {
      observer.observe(elem);
    })
  </script>

</body>

</html>
