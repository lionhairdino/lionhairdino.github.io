<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>lionhairdino - 얌파 Yampa (작성 예정)</title>

        <meta name="description" content="lionhairdino - 얌파 Yampa (작성 예정)" />
        <meta property="og:description" content="하스켈 함수형 프로그래밍" />

        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="icon" href="https://lionhairdino.github.io/favicon.svg" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino16px.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino24px.png" sizes="24x24" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino32px.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino48px.png" sizes="48x48" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino57px.png" sizes="57x57" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino60px.png" sizes="60x60" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino64px.png" sizes="64x64" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino72px.png" sizes="72x72" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino76px.png" sizes="76x76" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino114px.png" sizes="114x114" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino120px.png" sizes="120x120" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino144px.png" sizes="144x144" />
        <link rel="shortcut icon" href="../favicon.ico" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino152px.png" sizes="152x152" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino180px.png" sizes="180x180" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino192px.png" sizes="192x192" />
        <link rel="manifest" href="../site.webmanifest" />
        <link rel="mask-icon" href="https://lionhairdino.github.io/Lionhairdino_black.svg" color="#ff7500" />
        <meta name="msapplication-TileImage" content="/images/favicon/Lionhairdino144px.png" />
        <meta name="msapplication-TileColor" content="#ff7500" />
        <meta name="theme-color" content="#ffffff" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="얌파 Yampa (작성 예정)" />
        <meta property="og:site_name" content="Lionhairdino" />
        <meta property="og:url" content="https://lionhairdino.github.io/posts/2023-10-29-yampa.html" />

        <meta property="og:image" content="https://lionhairdino.github.io/images/state400px.png" />

      <meta name="keywords" content="FRP, Functional Reactive">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E9WZ6VXGHP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-E9WZ6VXGHP');
</script>
<script src="../script/copycode.js"></script>
<script async src="https://cse.google.com/cse.js?cx=9c53b4915cbb2605c"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css" />
    </head>
    <body>
        <div id="header">
            <div style="display:inline-block;margin-right:5px;padding-top: 5px;" id="logo">
                <a href="../"><img style="width:30px;border:none" src="../images/favicon/Lionhairdino48px.png"></a>
            </div>
            <div style="display:inline-block;vertical-align: top;padding-top:5px;" id="navigation">
                <a href="../">lionhairdino</a>
                <a href="../about.html">about</a>
                <!--<a href="/archive.html">archive</a>-->
            </div>
            <div style="display:inline-block;font-size:0.8em;vertical-align: top;">
                <div style="display:inline-block;vertical-align: top;padding-top: 5px">사이트내 검색</div>
                <div style="display:inline-block;width:180px;"> 
                    <div class="gcse-searchbox-only"></div>
                </div>
            </div>
            <div>
                여기 글들은 일종의 질문입니다. 용어 선택도 학계, 업계에서 쓰는 걸로 되어 있지 않고, 틀린 내용이 있을 수도 있습니다.
            </div>
        </div>
        <div class="js-toc-content">
            <h1>얌파 Yampa (작성 예정)</h1>
            <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
<div class="info">
    Posted on October 29, 2023
    
</div>

<p>Tue Nov 14 08:08:18 PM KST 2023 스케치 중…</p>
<p><a href="https://github.com/ivanperez-keera/Yampa">ivanperez-keera / Yampa</a></p>
<p><a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.65.8016&amp;rep=rep1&amp;type=pdf&amp;rct=j&amp;q=yampa%20arcade&amp;ei=p2b6TPv4HMOBlAe0luW4DA&amp;usg=AFQjCNEIW_IZQ9qAg-Jc8RbGfx9981RJBw&amp;sig2=k1V5vp6kH16B3U0-wNV00w">The Yampa Arcade</a>
<a href="https://github.com/ivanperez-keera/SpaceInvaders">ivanperez-keera / SpaceInvaders</a></p>
<p><a href="https://yampa-book.readthedocs.io/en/latest/index.html">Yampa Book</a></p>
<p>Arrowized FRP</p>
<p>Arrow 인터페이스를 이용해서 FRP 프레임워크 구현</p>
<h2 id="signal-sf-signal-function">Signal, SF (Signal Function)</h2>
<p>얌파는 두 가지 핵심 개념을 기반으로 만들었다.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 시그널 </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dt">Signal</span> α ≃ <span class="dt">Time</span> <span class="ot">-&gt;</span> α</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- 시그널 함수 </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="dt">SF</span> α β ≃ <span class="dt">Signal</span> α <span class="ot">-&gt;</span> <span class="dt">Signal</span> β</span></code></pre></div>
<p>Reactive-Banana에서는 Conal Elliot 논문과 같은 Behavior (<code>t -&gt; a</code>)와 Event (<code>(t,a)</code>)에서 시작했다. 얌파는 “특정 시간에만 존재하는 Event” 즉, <code>(Time, Event)</code> 모양이 없다. Behavior와 Event를 최대한 비슷하게 표현하면,</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">Behavior</span> <span class="ot">=</span> [b, b, b, b, b, <span class="op">...</span>] <span class="co">-- [ Just b,  Just b, Just b,  Just b, ...]</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dt">Event</span>    <span class="ot">=</span> [_, _, e, _, e, <span class="op">...</span>] <span class="co">-- [Nothing, Nothing, Just e, Nothing, ...]</span></span></code></pre></div>
<p>이런 모양으로 표현할 수도 있다. 아마도 얌파에선 <code>Signal</code>로 둘 모두를 표현했다고 보면 되겠다.<br />
※ 연속 시간을 음이 아닌 실수로 표현한다.
<code>SF</code> 해석을 어떻게 하면 좋을까? <code>Signal α</code>란 걸 주면 <code>Signal β</code>로 바꿔놓는 함수다.
<code>α</code> 를 돌려주던 함수에서 <code>β</code>를 돌려주는 함수로 바뀌었다. 무슨 의미일까?
<code>Time</code>을 주면 <code>α</code>를 내어 줄 준비를 하고 있었는데, 이를 변환 <code>β</code>를 내어주게 변환한다. 어떻게 변환할지는 이를 받아가는 모피즘, 즉 런타임의 동작을 봐야 한다. (Signal α, Signal β) 에서 (,)는, 이를 만나는 모피즘들이 모두 별 일을 하지 않는다. 그저 단순히 두 개의 정보를 “함께” 가지고 있다는 뜻이다. SF는 (,)자리에 (-&gt;)를 넣어 정의했다. (-&gt;) (Signal α) (Signal β), 나중 SF와 만나는 Runner들이 이 걸 실행하든, 다른 것과 합성하든 할 것이다. 뭘 할지는 그들에게 달렸다.
프로그램 플로우 차트로 비유하자면, 마치 라인이 <code>Signal</code>이고, 박스 요소들이 <code>SF</code>로 볼 수 있다고 한다. <code>SF</code>는 어찌 됐든 함수를 래핑해 놨으니, <code>SF</code>만을 위한 컴비네이터들을 만들어 쓸 거라고 예측할 수 있다.</p>
<h2 id="arr">arr</h2>
<p><code>SF</code>는 <code>(t -&gt; a) -&gt; (t -&gt; b)</code>타입의 함수를 래핑한 타입이다. <code>(a -&gt; b)</code> 함수를 <code>SF</code>로 만들어 보자.</p>
<p><code>f :: a -&gt; b</code> 함수를 받아서, 어떻게 <code>SF{ (g :: t -&gt; a) -&gt; (h :: t -&gt; b) }</code> 로 바꿀까?</p>
<p>f a</p>
<blockquote>
<p>함수를 변환하는 연습을 해보자.</p>
<ol type="1">
<li>일단 <code>a</code>를 결정하려면 <code>g</code>에 <code>t</code>를 넣어줘야 한다.<br />
<code>a = g t</code></li>
<li><code>a</code>를 결정했으니, <code>f</code>를 적용할 수 있다.<br />
<code>b = f (g t)</code></li>
<li><code>b</code>가 나왔다. 최종 결과는 <code>t</code>를 받아서 <code>b</code>를 돌려주는 함수다.<br />
<code>\t -&gt; f (g t)</code></li>
<li>이제 마지막으로 <code>f</code>를 받도록 만들면 된다.<br />
<code>\f -&gt; \t -&gt; f (g t)</code></li>
</ol>
</blockquote>
<p>타입이 딱 요네다다.<br />
&gt; Nat(Hom(-,a), Hom(-,b)) ~= (Hom(-,b)) a
&gt;
&gt;</p>
<p>원문에선 <code>g</code>대신 <code>s</code>를 쓰고 있다.<br />
※ <a href>The Yampa Arcade - 3.2 Composing Signal Functions</a> 참고</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ot">arr ::</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">SF</span> a b</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>arr f <span class="ot">=</span> \s <span class="ot">-&gt;</span> \t <span class="ot">-&gt;</span> f (s t)</span></code></pre></div>
<p>이제 일반 함수를 <code>arr</code>을 써서 리프팅할 수 있다.</p>
<p>※ <a href="../posts/2021-05-07-callbackTraining.html">함수가 들어있는 데이터 타입의 펑크터 만들기</a> 참고</p>
<p><a href="https://reasonablypolymorphic.com/blog/yampa-frp/index.html">FRP in Yampa: Part1 - Reasonably Polymorphic</a></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ot">controller ::</span> <span class="dt">SF</span> () <span class="dt">Controller</span></span></code></pre></div>
<p><code>()</code> 컨트롤러 값을 얻기 위해서 아무 것도 넣어 줄 필요가 없다는 뜻.</p>
<p>SF i o</p>
<p>얌파 프리미티브 중에 하나 <code>(delay)</code>
<code>(&gt;&gt;&gt;)</code> SF 합성널</p>
<pre><code>aState :: SF () Bool
aStateTwoSecondsAgo :: SF () Bool

integral :: Fractional a =&gt; SF a a</code></pre>
<p>transformer 우리말로 번역하면 변환기 정도 되겠다.
SF는 연속 시그널 변환기다.
머릿속이 모호한 이유는 바로 “연속” 때문이다. 연속이란 개념을 어떻게 처리했을 것인가?
무한 재귀 정의를 봤을 때와 마찬가지다. 무한하게 정의했다고, 무한하게 “동작”을 매 순간 계속 하고 있는 것이 아니다. 모든 대상들은 모피즘을 만나야 의미가 생긴다. 무한히 동작하지만, 어느 순간에, 혹은 어느 순간 까지만 필요하다는 모피즘을 반드시 파트너로 가지고 있다.
아마도 이 연속이란 개념도 그러할 것이다. 시그널 Time -&gt; α는, 함수로 되어있다. 이 상태론 <code>α</code>를 알 수 없다. 원하는 시간을 넣어주는 파트너와 만날 것이다. 그 파트너가 언제 찾아 올지 모르니, 특정 시간에만 존재하는 값이 아니라, <strong>모든 시간에 대응하는 값이 있다</strong>고 볼 수 있다.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">Event</span> a</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span> <span class="dt">Event</span> a</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">NoEvent</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ot">after ::</span> <span class="dt">Time</span> <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> <span class="dt">SF</span> a (<span class="dt">Event</span> b)</span></code></pre></div>
<p>시간과 <code>b</code>를 받아 시그널 함수를 돌려준다. 이 시그널 함수는 언젠가 <code>a</code>가 들어오면, <code>Event b</code>를 돌려준다. <code>Event</code>는 마치 <code>Maybe</code>와 비슷하다. Event가 있거나 없거나다. 5초 후에 알람을 맞춘다면, <code>after 5 () :: SF a (Event ())</code>로 두면 된다.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ot">edge ::</span> <span class="dt">SF</span> <span class="dt">Bool</span> (<span class="dt">Event</span> ())</span></code></pre></div>
<p><code>after 5 ()</code>는 5초 후에 시그널 함수가 동작한다면, edge는 입력 Bool값이 바뀌면 시그널 함수를 동작시킨다.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ot">hold ::</span> a <span class="ot">-&gt;</span> <span class="dt">SF</span> (<span class="dt">Event</span> a) a</span></code></pre></div>
<p><code>SF</code> 함수들을 <code>&gt;&gt;&gt;</code>로 모두 연결해 놓으면서 프로세스가 완성된다. Runner가 이들을 받아서 어떤 식으로 정리해서 동작시킬지는 아직 설명하지 않는다. 그러니, SF 함수가 머릿속에서 모호하게 남아 있다. 실제 구현을 보여주진 않더라도, 어떤 아이디어가 동작할지는 얘기해줘야 하지 않을까?</p>
<p>혼자 상상해 보자. Runner는 어떤 일을 하게 될까?
<code>(Time -&gt; α) -&gt; (Time -&gt; β)</code> 뭉치를 받아서 뭘 하면 될까?
오른쪽 화살표가 눌리면, 그 것으로 끝이 아니다.
누군가는 그 걸 가져가 좌표값을 오른 쪽으로 바꿔 놓으면,
누군가는 그 걸 받아 화면을 다시 그려야 한다.</p>
<p>이 건 그동안 리스너를 콜백으로 넘겨주던 패턴과 다르지 않다.
어떤 식으로든 누가 누구를 리스닝할지는 지정해야 한다.
지정하는 방식에 분명 차이가 있을 것이다.</p>
<p>개개의 개체들이 리스너를 관리했다면, 총감독을 두어 관리 할 수도 있을 것이다.
이 때, Free 모나드와 비슷하게 체인을 엮은 구조로 만들어 두고 이를 총감독이 관리한다는 것 아닐까?
파이프에 이벤트 흐름이 흘러가게 두고,
누가 리스닝할지 모르지만, 이벤트에 이름을 붙여 파이프에 넣는 것이다. 그런데, 파이프에 흐름이 하나만 있는 건 아니다. 몇 개의 흐름이 있던 상관 없다. 총감독은 이 흐름들을 모두 지켜보고 있다.
내가 어떤 이벤트를 리스닝할지는 파이프에게만 알려주면 된다. 파이프가 총감독이다. 이 걸 의미하는 것일까?
SF는 이 파이프 안에서 “단위”처럼 동작하는 것 같다. 이벤트를 리스닝 한 후의 결과도 SF다.
A가 이런 이벤트를 발생 시키면,
B가 받아서 어떤 작업을 하는 것으로 끝나는 게 아니라,
B도 이어지는 이벤트를 발생 시키는 것이다.
이 걸 이벤트가 “변환”된 것으로 표현한다.
마치 모든 흐름은 파이프 안에서 이루어지고, 그저 잠깐 잠깐 상태를 바깥에서 지켜 볼 뿐이다.</p>
<p>어떤 것이 어떤 것의 영향을 받는다면, “동시”라는 개념은 존재하지 않는다. 의존성이 있다면 순서는 반드시 정해진다.</p>
<p>엘리엇의 FRP의 핵심 키워드는 “연속”이다. 연속을 어떻게 모델링할 것인가다. 가장 프리미티브한 모양을 t-&gt;α로, 함수로 시작한다. 생각해보면, 연속을 표현하는데 이 거만한 게 있을까 싶다.
SF는 이벤트가 흘러갈 경로를 만드는 프리미티브다.
파이프 안에는</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>SF ----&gt; SF ----&gt; SF ----&gt;...</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>            SF ----&gt; SF ----&gt; SF ----&gt;...</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    SF ----&gt; SF -+--&gt; SF ----&gt;...</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                 |</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                 +----&gt; SF ----&gt; ...</span></code></pre></div>
<p>이 존재한다.</p>

<div class="comment">
<script src="https://utteranc.es/client.js" repo="lionhairdino/lionhairdino.github.io" issue-term="url" theme="github-light" crossorigin="anonymous" async>
</script>
</div>
<div style="text-align:right">Github 계정이 없는 분은 메일로 보내주세요. lionhairdino at gmail.com </div>
        </div>
        <nav class="toc toc-right js-toc relative z-1 transition--300 absolute pa4 pt5 is-position-fixed"></nav>
        <div id="footer">
            © 2022 lionhairdino. All rights reserved. Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
        <script>
            tocbot.init({
                tocSelector: '.js-toc',
                contentSelector: '.js-toc-content',
                headingSelector: 'h2, h3',
                hasInnerContainers: true,
            });
        </script>
    </body>
</html>
