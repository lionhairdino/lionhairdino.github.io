<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>lionhairdino - 코모나드 comonad</title>

        <meta name="description" content="코모나드를 향한 수학쪽에서의 입구가 아니라, 프로그래밍적인 입구입니다." />
        <meta property="og:description" content="코모나드를 향한 수학쪽에서의 입구가 아니라, 프로그래밍적인 입구입니다." />

        <link rel="stylesheet" type="text/css" href="../css/default.css" />
        <link rel="icon" href="https://lionhairdino.github.io/favicon.svg" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino16px.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino24px.png" sizes="24x24" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino32px.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino48px.png" sizes="48x48" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino57px.png" sizes="57x57" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino60px.png" sizes="60x60" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino64px.png" sizes="64x64" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino72px.png" sizes="72x72" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino76px.png" sizes="76x76" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino114px.png" sizes="114x114" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino120px.png" sizes="120x120" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino144px.png" sizes="144x144" />
        <link rel="shortcut icon" href="../favicon.ico" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino152px.png" sizes="152x152" />
        <link rel="apple-touch-icon-precomposed" href="../images/favicon/Lionhairdino180px.png" sizes="180x180" />
        <link rel="icon" type="image/png" href="../images/favicon/Lionhairdino192px.png" sizes="192x192" />
        <link rel="manifest" href="../site.webmanifest" />
        <link rel="mask-icon" href="https://lionhairdino.github.io/Lionhairdino_black.svg" color="#ff7500" />
        <meta name="msapplication-TileImage" content="/images/favicon/Lionhairdino144px.png" />
        <meta name="msapplication-TileColor" content="#ff7500" />
        <meta name="theme-color" content="#ffffff" />
        <meta property="og:type" content="website" />
        <meta property="og:title" content="코모나드 comonad" />
        <meta property="og:site_name" content="Lionhairdino" />
        <meta property="og:url" content="https://lionhairdino.github.io/posts/2021-05-06-comonad.html" />

        <meta property="og:image" content="https://lionhairdino.github.io/images/state400px.png" />

      <meta name="keywords" content="Monad, Comonad, co모나드">
<script src="../script/copycode.js"></script>
<script async src="https://cse.google.com/cse.js?cx=9c53b4915cbb2605c"></script>

    </head>
    <body>
        <div id="header">

            <div style="float:left;margin-right:15px;" id="logo">
                <img style="width:30px;" src="../images/favicon/Lionhairdino48px.png">
            </div>
            <div style="float:left" id="navigation">
                <a href="../" style="padding-top:10px">lionhairdino</a> 
                <a href="../about.html">about</a>
                <!--<a href="/archive.html">archive</a>-->
            </div>
            <div style="float:right;width:200px;"> 
                <div class="gcse-searchbox-only"></div>
            </div>
        </div>
        <div id="content">
            <h1>코모나드 comonad</h1>

            <link rel="stylesheet" type="text/css" href="../css/syntax.css" />
<div class="info">
    Posted on May  6, 2021
    
</div>

<p>모나드 트라우마로 움찔한 분들은 코모나드란 용어가 나오기 전까진 코모나드는 잠깐 잊어버리고 보는 게 더 나을 수 있습니다.</p>
<p>지금까지 알게 모르게 이미 아래 같은 패턴으로 코딩한 적이 있을 수도 있습니다. 아래서 참조한 가브리엘 글의 제목도 you could have invented comonads 입니다.</p>
<p>몸풀기를 잠깐 하고 넘어 가도록 하겠습니다.</p>
<p>고차 함수, 람다 함수를 활용한 방법</p>
<h4 id="가-인자-하나를-넣어-주면-속성을-지정해서-가지고-있는-것과-같습니다.">(가) – 인자 하나를 넣어 주면, 속성을 지정해서 가지고 있는 것과 같습니다.</h4>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ot">haveProperty ::</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> ( (<span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>) <span class="ot">-&gt;</span> <span class="dt">Int</span> )</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>haveProperty x <span class="ot">=</span> \f <span class="ot">-&gt;</span> f x</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="kw">let</span> personA <span class="ot">=</span> haveProperty <span class="dv">10</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="kw">let</span> personB <span class="ot">=</span> haveProperty <span class="dv">100</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> personA (<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> personB (<span class="op">+</span><span class="dv">20</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dv">120</span></span></code></pre></div>
<h4 id="나-미리-함수를-넣어-놓는-방식도-가능합니다.">(나) – 미리 함수를 넣어 놓는 방식도 가능합니다.</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ot">haveFunc ::</span> (<span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>) <span class="ot">-&gt;</span> (<span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>haveFunc f <span class="ot">=</span> \x <span class="ot">-&gt;</span> f (x <span class="op">+</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="kw">let</span> toolA<span class="ot">=</span> haveFunc (<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="kw">let</span> toolB <span class="ot">=</span> haveFunc (<span class="op">+</span><span class="dv">3</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> toolA <span class="dv">1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> toolB <span class="dv">1</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span></code></pre></div>
<h4 id="다-그리고-표현을-매끄럽게-하기-위해-기존-oop에서-쓰던-익숙한-흐름으로-바꾸기-위해-함수명과-인자-순서를-거꾸로-써주기-위한-연산자를-정의합니다.">(다) – 그리고, 표현을 매끄럽게 하기 위해 (기존 OOP에서 쓰던 익숙한 흐름으로 바꾸기 위해) 함수명과 인자 순서를 거꾸로 써주기 위한 연산자를 정의합니다.</h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ot">(#) ::</span> a <span class="ot">-&gt;</span> (a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> b</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">#</span> f <span class="ot">=</span> f x</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">infixl</span> <span class="dv">0</span> <span class="op">#</span></span></code></pre></div>
<p>※ 아래는 Gabriel Gonzalez의 블로그 <a href="https://www.haskellforall.com/2013/02/you-could-have-invented-comonads.html" class="uri">https://www.haskellforall.com/2013/02/you-could-have-invented-comonads.html</a>의 코드 일부를 발췌했습니다.</p>
<h2 id="builder-패턴">Builder 패턴</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">Option</span> <span class="ot">=</span> <span class="dt">String</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">Builder</span> <span class="ot">=</span> [<span class="dt">Option</span>] <span class="ot">-&gt;</span> <span class="dt">Config</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">Config</span> <span class="ot">=</span> <span class="dt">MakeConfig</span> [<span class="dt">Option</span>] <span class="kw">deriving</span> (<span class="dt">Show</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ot">defaultConfig ::</span> <span class="dt">Builder</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>defaultConfig options <span class="ot">=</span> <span class="dt">MakeConfig</span> ([<span class="st">&quot;-default&quot;</span>] <span class="op">++</span> options)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="ot">opt1 ::</span> <span class="dt">Builder</span> <span class="ot">-&gt;</span> <span class="dt">Config</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>opt1 builder <span class="ot">=</span> builder [<span class="st">&quot;-opt1&quot;</span>, <span class="st">&quot;-opt1-1&quot;</span>]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="ot">opt2 ::</span> <span class="dt">Builder</span> <span class="ot">-&gt;</span> <span class="dt">Config</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>opt2 builder <span class="ot">=</span> builder [<span class="st">&quot;-opt2&quot;</span>]</span></code></pre></div>
<p>위 도구에서 보았던 속성을 먼저 가지고 있는 스타일로 옵션 지정을 하는 코드입니다. 빌더 함수를 넣어서 안에 들어 있는 리스트에 적용합니다.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> defaultConfig <span class="op">#</span> opt1</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="dt">MakeConfig</span> [<span class="st">&quot;-default&quot;</span>,<span class="st">&quot;-opt1&quot;</span>,<span class="st">&quot;-opt1-1&quot;</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> defaultConfig <span class="op">#</span> opt2</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="dt">MakeConfig</span> [<span class="st">&quot;-default&quot;</span>,<span class="st">&quot;-opt2&quot;</span>]</span></code></pre></div>
<h2 id="아직-일이-끝나지-않았다---실행되지-않은-함수">아직 일이 끝나지 않았다 -&gt; 실행되지 않은 함수</h2>
<p>하지만 <code>opt1</code>과 <code>opt2</code>는 완성된 <code>Config</code>를 리턴합니다. 그럼 <code>opt1</code>과 <code>opt2</code> 두 개 모두 옵션 리스트에 넣으려면 어떻게 할까요? 최종 모양부터 상상하면, (다)를 이용해서 <code>defaultConfig # opt1 # opt2</code> 쯤 되는 모양으로 만들려고 합니다. 하스켈에선 뭔가 연이은 동작을 만들 땐 함수로 엮는 방법이 주로 쓰입니다. ※ 무언가 완성되지 않은 상태로 둔다는 말은 <em>“함수”로 만들어 둔다</em>와 같은 말입니다. 이 것도 함수형 스타일로 생각하는 하나의 팁입니다.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ot">opt1' ::</span> <span class="dt">Builder</span> <span class="ot">-&gt;</span> <span class="dt">Builder</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>opt1' builder <span class="ot">=</span> \options <span class="ot">-&gt;</span> builder ([<span class="st">&quot;-opt1&quot;</span>, <span class="st">&quot;-opt1-1&quot;</span>] <span class="op">++</span> options)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="ot">opt2' ::</span> <span class="dt">Builder</span> <span class="ot">-&gt;</span> <span class="dt">Builder</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>opt2' builder <span class="ot">=</span> \options <span class="ot">-&gt;</span> builder ([<span class="st">&quot;-opt2&quot;</span>] <span class="op">++</span> options)</span></code></pre></div>
<p>이미 가지고 있던 속성에 인자로 받아 온 함수를 적용했는데, 이 걸 바로 실행하지 않고, 인자 하나를 더 받을때까지 실행을 미루기 위해 (나) 방식으로 만들어 놓습니다.</p>
<p><code>Builder -&gt; Config</code>였던 타입이 <code>Builder -&gt; Builder</code>가 되어, 옵션 체인을 만들 수 있도록 입출력 타입이 같게 되었습니다.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>            builder  [<span class="st">&quot;-opt1&quot;</span>, <span class="st">&quot;-opt1-1&quot;</span>] <span class="co">-- opt1 결과가 Config 타입</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>\options <span class="ot">-&gt;</span> builder ([<span class="st">&quot;-opt1&quot;</span>, <span class="st">&quot;-opt1-1&quot;</span>] <span class="op">++</span> options) <span class="co">-- opt' 결과가 Builder 타입 = [Options] -&gt; Config</span></span></code></pre></div>
<p>그리고, 더 이상 연결할 옵션이 없을 때 완성된 <code>Config</code>를 뽑아내기 위해 <code>extract</code>를 만듭니다.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ot">extract ::</span> <span class="dt">Builder</span> <span class="ot">-&gt;</span> <span class="dt">Config</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>extract builder <span class="ot">=</span> builder []</span></code></pre></div>
<p>그럼 아래와 같이 체인 형태로 쓸 수 있습니다.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> defaultConfig <span class="op">#</span> opt1' <span class="op">#</span> opt2' <span class="op">#</span> extract</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dt">MakeConfig</span> [<span class="st">&quot;-default&quot;</span>,<span class="st">&quot;-opt1&quot;</span>,<span class="st">&quot;-opt1-1&quot;</span>,<span class="st">&quot;-opt2&quot;</span>]</span></code></pre></div>
<p>이렇게 <code>opt</code>를 <code>opt'</code>으로 만들면 체인이 가능하게 됩니다. 그럼 만약 기존 코드가 이미 <code>opt</code> 스타일로 많이 만들어졌다면, 일일이 <code>Builder</code> 리턴 타입으로 바꾸는 것보다 변환 함수를 하나 만들어 쓰는게 좋습니다. 헛갈리지 않게 opt1과 opt2의 람다 변수 이름을 바꿔 놓겠습니다.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>opt1 <span class="ot">=</span> \bf <span class="ot">-&gt;</span> bf [<span class="st">&quot;-opt1&quot;</span>, <span class="st">&quot;-opt1-1&quot;</span>]</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>opt2 <span class="ot">=</span> \bf <span class="ot">-&gt;</span> bf [<span class="st">&quot;-opt2&quot;</span>]</span></code></pre></div>
<p><code>opt1</code> 안에 들어 있는 옵션과 <code>opt2</code> 안에 들어 있는 옵션을 묶어 놓고, 바깥에서 들어온 <code>builder</code>를 적용하는 모양이 되어야 합니다. 처음엔 함수를 변형한다고 하니, 함수를 어떻게 해체해야 하는지 난감했습니다. <em>opt1 함수를 변형하는 방법 중 하나는 어떤 함수를 넣어 정보를 해체하는 겁니다.</em></p>
<h2 id="완성되어-있는-고차-함수-내부를-조작하려면">완성되어 있는 고차 함수 내부를 조작하려면?</h2>
<p>함수가 외부와 소통하는 방법은 매개 변수뿐이 없습니다. 값을 주고 받을 때 뿐만 아니라, 함수 동작을 조작할때도 이용할 수 있는 통로는 매개 변수뿐이 없습니다. 안 쪽에 들어가서 변형시켜 놓을 함수(가)를 매개 변수에 넣어주면 됩니다. 변형된 모양은</p>
<pre class="hasekll"><code>\o -&gt; \builder -&gt; ... builder ( ... )  </code></pre>
<p>빌더 타입이어야 합니다.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>\builder <span class="ot">-&gt;</span> \o2 <span class="ot">-&gt;</span>     (\bf <span class="ot">-&gt;</span> bf [<span class="st">&quot;-opt1&quot;</span>,<span class="st">&quot;-opt1-1&quot;</span>])      (\o1 <span class="ot">-&gt;</span> builder (o1 <span class="op">++</span> o2))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                       <span class="op">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span>      <span class="op">^^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                                   original                 o1을 뽑아 o2와 합치는 함수 <span class="co">-- (가)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>\builder <span class="ot">-&gt;</span> \o2 <span class="ot">-&gt;</span>     builder ([<span class="st">&quot;-opt1&quot;</span>,<span class="st">&quot;-opt1-1&quot;</span>] <span class="op">++</span> o2) </span></code></pre></div>
<p><code>\o1</code>으로 <code>opt1</code>이 가진 옵션을 뽑아내 나중에 들어 올 <code>o2</code>와 합쳐 놓습니다. 위에서 본 <code>opt1'</code>과 같은 모양이 나왔습니다. 변형해 주는 함수를 <code>extend</code>라 이름 붙이면 다음과 같이 정리할 수 있습니다.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>extend original <span class="ot">=</span> \builder <span class="ot">-&gt;</span> \o2 <span class="ot">-&gt;</span> original (\o1 <span class="ot">-&gt;</span> builder (o1 <span class="op">++</span> o2)) </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>extend original builder <span class="ot">=</span> \o2 <span class="ot">-&gt;</span> original (\o1 <span class="ot">-&gt;</span> builder (o1 <span class="op">++</span> o2))</span></code></pre></div>
<p><code>extend</code>를 정의한 후에는 원래 함수에 <code>extend</code>를 적용해주면 위의 최종 결과와 같은 결과가 나옵니다.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> defaultConfig <span class="op">#</span> extend opt1 <span class="op">#</span> extend opt2 <span class="op">#</span> extract</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="dt">MakeConfig</span> [<span class="st">&quot;-default&quot;</span>,<span class="st">&quot;-opt1&quot;</span>,<span class="st">&quot;-opt1-1&quot;</span>,<span class="st">&quot;-opt2&quot;</span>]</span></code></pre></div>
<h2 id="코모나드">코모나드</h2>
<p>위에서 나온 extract, extend의 조합이 바로 코모나드입니다.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- extract :: Builder -&gt; Config </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- type Builder a = [Option] -&gt; a 으로 볼 수 있습니다.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="ot">extract ::</span> <span class="dt">Builder</span> a <span class="ot">-&gt;</span> a</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="ot">extend ::</span> (<span class="dt">Builder</span> a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> <span class="dt">Builder</span> a <span class="ot">-&gt;</span> <span class="dt">Builder</span> b</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- 코모나드 메소드</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="ot">extract ::</span> w a <span class="ot">-&gt;</span> a</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="ot">extend ::</span> (w a <span class="ot">-&gt;</span> b) <span class="ot">-&gt;</span> w a <span class="ot">-&gt;</span> w b</span></code></pre></div>
<p>가브리엘 곤잘레즈 글의 첫 번째 섹션의 소스 코드를 옮겨서 풀어 봤는데, 읽고 나니 원 글이 훨씬 나아 보입니다. 여기 글은 <code>extend</code> 정의가 쉽게 이해가지 않을 때 보충해서 보면 좋을 것 같습니다.</p>
<p>수학적으로 모나드의 듀얼이라 하고 시작하는 순간부터, 또 한번의 모나드 전쟁이 생기진 않을까 두려워집니다. 이론적인 바탕보다 먼저 코드로 풀이한 후 접근하는 게 편한 분들도 있을 겁니다. 모나드만큼 여기 저기 쓰이는 패턴은 아닙니다. 원 글에 따르면 하스켈에서 모나드가 명령형 프로그래밍 비슷한 모양을 보여준다면, 코모나드는 OOP스런 모양을 보여주는 패턴이라 합니다.</p>
<p>나중에 코모나드와 연관된 글을 더 올리도록 하고, 여기서는 <code>w a -&gt; b</code> 함수 연결(엮는 것)을 어떻게 하는지 보는 정도로 만족하고 넘어가겠습니다. 모나드도 특정 형태의 함수를 엮는 방법이고, 코모나드도 특정 형태의 함수를 엮는 방법입니다.</p>
<p><code>w a</code>로 표기한 이유는 <code>w</code>가 모나드의 <code>m</code>을 거꾸로 놓았다는 뜻에서 <code>w</code>를 쓴다고 합니다.</p>
<p>동작은 알겠는데, 이게 왜 모나드의 듀얼, 코모나드란 이름을 가졌을까요? 사실, 이런 건 궁금해하지 않고 넘어가도 되는데, 이런데서 머뭇거리는게 좋은 건지 나쁜 건지 모르겠습니다. 모나드는 <code>a -&gt; m a</code> 액션을 엮는 패턴이었습니다. 여기서 화살표를 반대로 한 걸 듀얼이라 한다는데, 이게 가지는 실용적인 의미가 뭘까요?</p>

<div class="comment">
<script src="https://utteranc.es/client.js" repo="lionhairdino/lionhairdino.github.io" issue-term="url" theme="github-light" crossorigin="anonymous" async>
</script>
</div>
<div style="text-align:right">Github 계정이 없는 분은 메일로 보내주세요. lionhairdino at gmail.com </div>
        </div>
        <div id="footer">
            © 2021 lionhairdino. All rights reserved. Generated by <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </div>
    </body>
</html>
